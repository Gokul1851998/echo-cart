<%-include('../admin/layout/admin-header-layout.ejs') -%>
<div class="container" style="min-height: 80vh !important;">
    <div class="row m-5">
      <div class="mb-3">
        <h2 class="section-title position-relative bg-info text-uppercase mb-3 ml-5"><span class=" pr-3 a">Coupons</span></h2>
</div>
        <div class="ml-auto mr-3">
        <a href="/admin/coupons"><button class="btn btn-success me-md-2 mb-3 ">Create Coupon</button></a>
    </div>
    <div class="col-lg-12 col-md-12 col-sm-12" style="overflow-x:auto;">
        <table class="table">
            <thead class="thead-dark">
              <tr>
                <th scope="col">#</th>
                <th scope="col">Name</th>
                <th scope="col">Code</th>
                <th scope="col">Discount</th>
                <th scope="col">Expired Date</th>
                <th scope="col">Minimum Amount</th>
                <th scope="col">Delete</th>
              </tr>
            </thead>
            <tbody>
                <% couponData.forEach((cop,index)=>{ %> 
              <tr>
                <th class="align-middle"><%= index+1 %> </th>
                <td class="align-middle"><%= cop.couponName  %></td>
                <td class="align-middle"><%= cop.couponId %></td>
                <td class="align-middle"><%= cop.couponDiscount %></td>
                <td class="align-middle"><%= cop.couponExpiredDate.toLocaleDateString() %></td>
                <td class="align-middle"><%= cop.Amount %></td>
                <td class="align-middle">
                  <button onclick="deleteCoupon('<%= cop._id %>')" class="btn btn-sm btn-danger" ><i class="fa fa-times"></i></button>
                </td>  
              </tr>
              <% }) %> 
             
            </tbody>
            <tbody><tr></tr></tbody>
          </table>
      

</div>
</div>
</div>


<script>
  function deleteCoupon(id) {
    console.log(id, "deleted id");
    Swal.fire({
      title: "Are you sure?",
      text: "You won't be able to revert this!",
      icon: "warning",
      customClass: "swal-wide",
      showCancelButton: true,
      confirmButtonColor: "#3085d6",
      cancelButtonColor: "#d33",
      confirmButtonText: "Yes, Block it!",
    }).then((result) => {
      if (result.isConfirmed) {
        location.href = `/admin/delete_coupon?id=${id}`;
        Swal.fire("Blocked!", "This Coupon is deleted.", "success").then(
          (result) => {
            location.reload();
          }
        );
      }
    });
  }
</script>


<%-include('../admin/layout/admin-footer-layout') -%> 